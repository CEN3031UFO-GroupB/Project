<container>
  <div class="page-header row">
    <h1 class="col-md-8">{{name}} Goals</h1>
    <button class="btn btn-default" style="float:right;margin-top: 25px;" ng-click="createGoal()" ng-hide="auth.user.roles[0] == 'admin'">New Goal</button>
    <div class="clearfix"></div>
    <h5 style="font-style: italic; padding-left: 10px" ng-hide="auth.user.roles[0] == 'admin'">{{diffDays}} days left to finish your goals</h5>
  </div>
  <h2 class="row">Current Goals</h2>
  <div class="row" id="currentWeek">
    <div class="list-group col-md-4">
      <h4 style="font-weight: bolder">To Do</h4>
      <div ng-repeat="goal in vm.goals"
           ng-if="(goal.status == 'Not Started')"
           class="list-group-item"
            style="margin-bottom: 5px;">
        <div class="row">
          <div class="col-md-1" style="position: relative; height: 100%; width: 20px; padding: 0px; margin-bottom: 0px; margin-top: 0px; bottom: 5px; clear: both;">
            <div style="background-color: #505050; width:1px;
            transform: rotate(-90deg); transform-origin: bottom right;
            position: relative; height: 100%; width: 100%; margin-left: -55px;
            margin-top: -25px; clear: both; padding-left: 10px;
            border-right: 65px solid #505050; color: white;"> {{goal.priority}}</div>
          </div>
          <div class="col-md-7" style="padding-right: 0px;">
            <h4 class="list-group-item-heading" style="display:block; font-weight: bold">{{goal.title}} </h4>
            <h5 class="list-group-item-heading" style="display:inline">{{goal.category}} </h5>
          </div>
          <div class="col-md-2">
            <button class="btn" style="padding-top: 0; padding-bottom: 0; margin-top: 6px; margin-bottom: 5px" ui-sref="goals.view({ goalId: goal._id })">View</button>
            <button class="btn btn-primary" style="padding-top: 0; padding-bottom: 0" ng-click="markGoalInProgress(goal)">Start</button>
          </div>
        </div>
      </div>
    </div>
    <div class="list-group col-md-4">
      <h4 style="font-weight: bolder">In Progress</h4>
      <div ng-repeat="goal in vm.goals"
           ng-if="(goal.status == 'In Progress')"
           class="list-group-item"
           style="margin-bottom: 5px;">
        <div class="row">
          <div class="col-md-1" style="position: relative; height: 100%; width: 20px; padding: 0px; margin-bottom: 0px; margin-top: 0px; bottom: 5px; clear: both;">
            <div style="background-color: #347fa5; width:1px;
            transform: rotate(-90deg); transform-origin: bottom right;
            position: relative; height: 100%; width: 100%; margin-left: -55px;
            margin-top: -25px; clear: both; padding-left: 10px;
            border-right: 65px solid #347fa5; color: white;"> {{goal.priority}}</div>
          </div>
          <div class="col-md-7" style="padding-right: 0px;">
            <h4 class="list-group-item-heading" style="display:block; font-weight: bold">{{goal.title}} </h4>
            <h5 class="list-group-item-heading" style="display:inline">{{goal.category}} </h5>
          </div>
          <div class="col-md-2">
            <button class="btn" style="padding-top: 0; padding-bottom: 0; margin-top: 6px; margin-bottom: 5px" ui-sref="goals.view({ goalId: goal._id })">View</button>
            <button class="btn btn-primary" style="padding-top: 0; padding-bottom: 0" ng-click="markGoalInProgress(goal)">Start</button>
          </div>
        </div>
      </div>
    </div>
    <div class="list-group col-md-4">
      <h4 style="font-weight: bolder">Completed</h4>
      <div ng-repeat="goal in vm.goals"
           ng-if="(goal.status == 'Complete') && ((goal.completed_at | date:'dd/MM/yyyy') > (monday | date:'dd/MM/yyyy'))"
           class="list-group-item"
           style="margin-bottom: 5px;">
        <div class="row">
          <div class="col-md-1" style="position: relative; height: 100%; width: 20px; padding: 0px; margin-bottom: 0px; margin-top: 0px; bottom: 5px; clear: both;">
            <div style="background-color: #248900; width:1px;
            transform: rotate(-90deg); transform-origin: bottom right;
            position: relative; height: 100%; width: 100%; margin-left: -55px;
            margin-top: -25px; clear: both; padding-left: 10px;
            border-right: 65px solid #248900; color: white;"> {{goal.priority}}</div>
          </div>
          <div class="col-md-7" style="padding-right: 0px;">
            <h4 class="list-group-item-heading" style="display:block; font-weight: bold">{{goal.title}} </h4>
            <h5 class="list-group-item-heading" style="display:inline">{{goal.category}} </h5>
          </div>
          <div class="col-md-2">
            <button class="btn" style="padding-top: 0; padding-bottom: 0; margin-top: 6px; margin-bottom: 5px" ui-sref="goals.view({ goalId: goal._id })">View</button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="alert alert-warning text-center" ng-if="vm.goals.$resolved && !vm.goals.length">
    No Goals yet, why don't you <a ui-sref="goals.create">create one</a>?
  </div>
</container>

<hr>
<h2 class="col-md-8">Previously Completed Goals</h2>
<div class="list-group">
  <table st-table="vm.oldGoals" id="goals-table" class="table table-striped">
    <thead>
    <th style="width:130px">Title</th>
    <th style="width:130px">Category</th>
    <th style="width:130px">Started On</th>
    <th style="width:130px">Completed On</th>
    </thead>
    <tbody>
    <tr ng-repeat="goal in vm.oldGoals" >
      <td ng-bind="goal.title"></td>
      <td ng-bind="goal.category"></td>
      <td ng-bind="(goal.started_at | date:'mediumDate')"></td>
      <td ng-bind="(goal.completed_at | date:'mediumDate')"></td>
    </tr>
    </tbody>
  </table>
</div>
<hr>
<div>
  <canvas id="bar" class="chart chart-line"
          chart-data="data" chart-labels="labels" chart-options="options" chart-series="series">
  </canvas>
</div>
